import sys
sys.stdout.reconfigure(encoding='utf-8')
import requests


TOKEN = ""


def send_reaction(chat_id, message_id, reaction):
    url = f"https://api.telegram.org/bot{TOKEN}/setMessageReaction"
    payload = {
        "chat_id": chat_id,
        "message_id": message_id,
        "reaction": [{"type": "emoji", "emoji": reaction}]  
    }
    response = requests.post(url, json=payload)
    if response.status_code == 200:
        print("✅ تم إضافة رد الفعل بنجاح!")
    else:
        print(f"❌ حدث خطأ: {response.text}")


def handle_message(update):
 
    chat_id = update["message"]["chat"]["id"]
    message_id = update["message"]["message_id"]
    
    # إضافة رد فعل (قلب ❤️)
    send_reaction(chat_id, message_id, "❤️")


def get_updates():
    offset = None
    while True:
        url = f"https://api.telegram.org/bot{TOKEN}/getUpdates"
        params = {"offset": offset, "timeout": 10}
        response = requests.get(url, params=params)
        if response.status_code == 200:
            updates = response.json().get("result", [])
            for update in updates:
                handle_message(update)
                offset = update["update_id"] + 1
        else:
            print(f"❌ حدث خطأ: {response.text}")

# تشغيل البوت
print("✅ البوت يعمل الآن...")
get_updates()
